from Standard.Base import all
from Standard.Table import all
from Standard.Database import all
from Standard.AWS import all
from Standard.Geo import all
from Standard.Google_Api import all
from Standard.Microsoft import all
from Standard.Snowflake import all
from Standard.Tableau import all
import Standard.Examples
import Standard.Visualization
from Standard.Base.Meta import Enso_Project

## Loading a database with snowboarding results. Parsing and afterwards calculated evaluating each result by Czech Ski guidelines.
table =
    project_description1 = Enso_Project.enso_project
    file1 = project_description1.root
    file2 = file1 / 'data.csv'
    any2 = Data.read file2
    table2 = any2.filter 'Event Name' (..Contains "Qualification" ..Insensitive ..Remove)
    table3 = table2.set (expr 'IF CONTAINS([Event Name] , \'European Cup\') OR CONTAINS([Event Name] , \'World University\') OR CONTAINS([Event Name] , \'Youth Olympic\') THEN 2 ELSE IF CONTAINS([Event Name] , \'World Cup\') THEN 4 ELSE IF CONTAINS([Event Name] , \'World Championships\') THEN 5 ELSE 0.5  ') "Base"
    table5 = table3.parse ['Rank'] type=(..Integer ..Bits_64) '' error_on_missing_columns=False
    table7 = table3.aggregate ['URL'] [..Count]
    table6 = table5.join table7 ..Inner [(..Equals 'URL')]
    table8 = table6.set (expr 'IF [Rank] < ([Count] + 1) / 2 THEN [Base] ELSE 0') "Points"
    table4 = table8.set (expr 'IF [Rank] = 1 THEN [Base] * 10 ELSE IF  [Rank] = 2 THEN [Base] * 8 ELSE IF  [Rank] = 3 THEN [Base] * 6  ELSE IF [Rank] >= 4 AND  [Rank] <= 8 THEN [Base] * 4 ELSE IF [Rank] >= 9 AND [Rank] <= 16 THEN [Base] * 2 ELSE 0 ') "Points"
    table4

## Creating a table only depending on an array of names. Exporting it as an excel file.
filter_write vector1 =
    table4 = Main.table
    table1 = table4.filter 'Athlete' (..Is_In vector1)
    table2 = table1.select_columns ['Athlete', 'Event Name', 'Date', 'Rank', 'Points']
    table3 = table2.fill_nothing ['Points'] 0
    file1 = table3.write (File.new './rozdeleni.xls') ..Workbook ..Overwrite
    table3

main =
    vector1 = ["TULACH Ondrej", "SONKA Antonin"]
    file1 = Main.filter_write vector1



#### METADATA ####
[[{"index":{"value":558},"size":{"value":25}},"14ffb778-2e6a-4495-899d-6db42f415793"],[{"index":{"value":596},"size":{"value":25}},"1610847e-9d73-4c98-87de-a81a974bca94"],[{"index":{"value":634},"size":{"value":18}},"0d1fa9b1-6860-42bf-8d09-72e0b9ff14aa"],[{"index":{"value":664},"size":{"value":9}},"eb47fbd3-3af5-49da-9650-9ca2cced37e6"],[{"index":{"value":664},"size":{"value":15}},"ab6ec869-ad9c-46eb-97ed-937a0bb19ddc"],[{"index":{"value":693},"size":{"value":11}},"02c2d649-cb19-48be-b14c-3d7f94658e80"],[{"index":{"value":693},"size":{"value":24}},"a4c619e2-0bec-4bfd-be3d-a557968c6dfe"],[{"index":{"value":693},"size":{"value":76}},"3d6f1b06-aaea-4e90-9ae2-a1e1ed02b477"],[{"index":{"value":783},"size":{"value":10}},"181df8b6-6336-4396-a997-8c82d334633b"],[{"index":{"value":783},"size":{"value":295}},"71f16802-15f6-4845-b98c-3dd7a152c3ee"],[{"index":{"value":783},"size":{"value":302}},"1bd9d65c-63e2-42ed-b9c0-f44b83e559de"],[{"index":{"value":1099},"size":{"value":12}},"39d419d3-a6c5-4697-9519-dc6f2f14991c"],[{"index":{"value":1099},"size":{"value":21}},"5c995f68-2b11-4532-8081-e7f3e3c25c5c"],[{"index":{"value":1099},"size":{"value":48}},"9dc6e642-c812-4697-8682-f21683dc3ebf"],[{"index":{"value":1099},"size":{"value":51}},"84ce0015-885a-4856-a8f2-8cf081a3f80b"],[{"index":{"value":1099},"size":{"value":82}},"e164ab03-17f1-44e6-b7be-758bc201394c"],[{"index":{"value":1195},"size":{"value":16}},"c2ac1ca4-0f0b-41f5-aa51-7856dab30e62"],[{"index":{"value":1195},"size":{"value":24}},"514e6985-75d9-4a52-b9fd-791baefe7df6"],[{"index":{"value":1195},"size":{"value":34}},"6a7c4185-6596-4030-b790-fa26ece6fec0"],[{"index":{"value":1243},"size":{"value":11}},"16bf8412-ac89-49c5-b9e1-fb242d4d1e16"],[{"index":{"value":1243},"size":{"value":18}},"6bab0a6b-3b3b-4ab6-9cfd-5f06af514f5f"],[{"index":{"value":1243},"size":{"value":26}},"d9624b89-d5b9-45a3-8260-3b80e6451712"],[{"index":{"value":1243},"size":{"value":45}},"2daf6f29-57e1-4b94-b323-fd9732342ef0"],[{"index":{"value":1302},"size":{"value":10}},"e30b1a91-b58f-4c72-8191-7b8391307e98"],[{"index":{"value":1302},"size":{"value":68}},"111fa804-2ef3-4a2d-8369-016b10ec74df"],[{"index":{"value":1302},"size":{"value":77}},"f5cb1777-9bf5-464c-a5f8-958d6e96f15e"],[{"index":{"value":1393},"size":{"value":10}},"b2d72795-8b52-4d36-8336-ef8c635dab22"],[{"index":{"value":1393},"size":{"value":237}},"57bd75d8-2453-4d2d-9008-6ce7db83072e"],[{"index":{"value":1393},"size":{"value":246}},"a886591e-4023-45ac-b617-fde23863f842"],[{"index":{"value":1644},"size":{"value":6}},"dc5a8ba8-a4f2-4d1c-a870-3d37588ecacf"],[{"index":{"value":1753},"size":{"value":7}},"e6958765-03ac-4f11-a1f2-0d8a1867040f"],[{"index":{"value":1776},"size":{"value":10}},"8baece96-352d-4d05-aaba-92c0ef99663f"],[{"index":{"value":1800},"size":{"value":13}},"0f02cd5f-d4ef-42b0-aa9d-ebb83952377e"],[{"index":{"value":1800},"size":{"value":23}},"40c4c00a-3313-4c95-9e33-7154a0d8e8a1"],[{"index":{"value":1800},"size":{"value":41}},"baa458c9-6bf9-4442-87da-33c36f26c604"],[{"index":{"value":1855},"size":{"value":21}},"5c8f0739-f93f-4c3f-b27c-09f70af7a12b"],[{"index":{"value":1855},"size":{"value":73}},"73ce0e51-cc89-48f4-8615-82fa9ca7ff6e"],[{"index":{"value":1942},"size":{"value":19}},"42a9ab7b-56c3-49fa-9149-226ca89314e3"],[{"index":{"value":1942},"size":{"value":30}},"8d3e3bde-397c-40bb-85da-23dde57a4d15"],[{"index":{"value":1942},"size":{"value":32}},"95097c87-20f2-4ad5-b410-80e82703c47d"],[{"index":{"value":1987},"size":{"value":12}},"ea5291d3-3494-48d9-9ed2-ad3009aeca5a"],[{"index":{"value":1987},"size":{"value":41}},"a285a91a-0268-4d1c-a6ee-30788fa464ea"],[{"index":{"value":1987},"size":{"value":52}},"7d43bddc-247b-4af7-aa91-718ffad50a1b"],[{"index":{"value":1987},"size":{"value":64}},"dc0d037e-ad8b-4c85-970e-0c76204cf36a"],[{"index":{"value":2056},"size":{"value":6}},"7c058047-c28d-4167-b1f3-7ace26f48bd7"],[{"index":{"value":2085},"size":{"value":34}},"ff994dcc-c7d3-4931-80f8-9ef9596663a1"],[{"index":{"value":2132},"size":{"value":25}},"c40059a5-de16-4063-b0a6-9528b7715021"]]
{"ide":{"node":{"14ffb778-2e6a-4495-899d-6db42f415793":{"position":{"vector":[978,92]},"visualization":{"show":false,"width":236.25,"height":102.5}},"1610847e-9d73-4c98-87de-a81a974bca94":{"position":{"vector":[1166,20]}},"0d1fa9b1-6860-42bf-8d09-72e0b9ff14aa":{"position":{"vector":[1019,-52]},"visualization":{"show":false,"width":269.3333333333333,"height":128.66666666666666}},"ab6ec869-ad9c-46eb-97ed-937a0bb19ddc":{"position":{"vector":[827,-128]},"visualization":{"show":true,"width":1750.046875,"height":274,"project":{"project":"Builtin"},"name":"Table"}},"eb47fbd3-3af5-49da-9650-9ca2cced37e6":{"position":{"vector":[822,-488]}},"3d6f1b06-aaea-4e90-9ae2-a1e1ed02b477":{"position":{"vector":[827,-319]},"visualization":{"show":false,"width":1332.8443003472432,"height":201.5104627795504}},"a4c619e2-0bec-4bfd-be3d-a557968c6dfe":{"position":{"vector":[-469,-610]}},"02c2d649-cb19-48be-b14c-3d7f94658e80":{"position":{"vector":[-469,-610]}},"1bd9d65c-63e2-42ed-b9c0-f44b83e559de":{"position":{"vector":[934,-516]},"visualization":{"show":false,"width":2027.296875,"height":360}},"71f16802-15f6-4845-b98c-3dd7a152c3ee":{"position":{"vector":[755,-340]}},"181df8b6-6336-4396-a997-8c82d334633b":{"position":{"vector":[755,-340]}},"e164ab03-17f1-44e6-b7be-758bc201394c":{"position":{"vector":[1019,-741]}},"84ce0015-885a-4856-a8f2-8cf081a3f80b":{"position":{"vector":[1250,-1036]}},"9dc6e642-c812-4697-8682-f21683dc3ebf":{"position":{"vector":[1250,-1036]}},"5c995f68-2b11-4532-8081-e7f3e3c25c5c":{"position":{"vector":[1250,-1026]}},"39d419d3-a6c5-4697-9519-dc6f2f14991c":{"position":{"vector":[1250,-1026]}},"6a7c4185-6596-4030-b790-fa26ece6fec0":{"position":{"vector":[1769,-741]},"visualization":{"show":false,"width":854.0625,"height":392.5}},"514e6985-75d9-4a52-b9fd-791baefe7df6":{"position":{"vector":[2850,-788]},"visualization":{"show":true,"width":854.0625,"height":392.5}},"c2ac1ca4-0f0b-41f5-aa51-7856dab30e62":{"position":{"vector":[2927,-788]}},"2daf6f29-57e1-4b94-b323-fd9732342ef0":{"position":{"vector":[1542,-935]},"visualization":{"show":false,"width":1120.0307835820895,"height":376.86567164179104}},"d9624b89-d5b9-45a3-8260-3b80e6451712":{"position":{"vector":[3069,-1884]}},"6bab0a6b-3b3b-4ab6-9cfd-5f06af514f5f":{"position":{"vector":[3069,-1884]}},"16bf8412-ac89-49c5-b9e1-fb242d4d1e16":{"position":{"vector":[3069,-1884]}},"f5cb1777-9bf5-464c-a5f8-958d6e96f15e":{"position":{"vector":[1323,-1054]},"visualization":{"show":false,"width":1000.3125,"height":271.25}},"111fa804-2ef3-4a2d-8369-016b10ec74df":{"position":{"vector":[3129,-2439]}},"e30b1a91-b58f-4c72-8191-7b8391307e98":{"position":{"vector":[3129,-2439]}},"a886591e-4023-45ac-b617-fde23863f842":{"position":{"vector":[934,-1216]},"visualization":{"show":true,"width":1644.01026119403,"height":526.1194029850745}},"57bd75d8-2453-4d2d-9008-6ce7db83072e":{"position":{"vector":[1088,-1108]}},"b2d72795-8b52-4d36-8336-ef8c635dab22":{"position":{"vector":[1088,-1108]}},"dc5a8ba8-a4f2-4d1c-a870-3d37588ecacf":{"position":{"vector":[934,-1814]}},"e6958765-03ac-4f11-a1f2-0d8a1867040f":{"position":{"vector":[975,-1810]}},"8baece96-352d-4d05-aaba-92c0ef99663f":{"position":{"vector":[975,-1882]},"visualization":{"show":true}},"baa458c9-6bf9-4442-87da-33c36f26c604":{"position":{"vector":[1224,-2250]},"visualization":{"show":false,"width":1073.828125,"height":271.8}},"40c4c00a-3313-4c95-9e33-7154a0d8e8a1":{"position":{"vector":[-10,-523]}},"0f02cd5f-d4ef-42b0-aa9d-ebb83952377e":{"position":{"vector":[-10,-523]}},"73ce0e51-cc89-48f4-8615-82fa9ca7ff6e":{"position":{"vector":[1051,-2322]}},"5c8f0739-f93f-4c3f-b27c-09f70af7a12b":{"position":{"vector":[822,-2751]}},"95097c87-20f2-4ad5-b410-80e82703c47d":{"position":{"vector":[1051,-2394]},"visualization":{"show":true,"width":885.1560632470118,"height":359.32270916334664}},"8d3e3bde-397c-40bb-85da-23dde57a4d15":{"position":{"vector":[877,-2926]}},"42a9ab7b-56c3-49fa-9149-226ca89314e3":{"position":{"vector":[877,-2926]}},"dc0d037e-ad8b-4c85-970e-0c76204cf36a":{"position":{"vector":[1295,-2943]}},"7d43bddc-247b-4af7-aa91-718ffad50a1b":{"position":{"vector":[1296,-2943]}},"a285a91a-0268-4d1c-a6ee-30788fa464ea":{"position":{"vector":[1705,-2779]}},"ea5291d3-3494-48d9-9ed2-ad3009aeca5a":{"position":{"vector":[1705,-2779]}},"7c058047-c28d-4167-b1f3-7ace26f48bd7":{"position":{"vector":[1162,-2943]}},"ff994dcc-c7d3-4931-80f8-9ef9596663a1":{"position":{"vector":[1408,-2035]}},"c40059a5-de16-4063-b0a6-9528b7715021":{"position":{"vector":[1094,-2212]},"visualization":{"show":true,"width":1541.7416044776119,"height":436.56716417910445}}},"widget":{},"import":{},"snapshot":"eJyNVF1TIkcUfedXnGIfBhKrFUVjqpZUschmrSgY0VgplqKuMxdobbon3Q2Ivz7VMwMIQTdvM3PPuR/n3jkja6boedIJ2UR8IceQ09RYD1KqNNqK3tGj+iB8QZ4eP0zQfOi9H/ydzQdBY8aKh81Uvo+5lrE1zoz8+5CeNouRoucfDUmzt4DicQ1pv9A0Vez+E/hLuhkp+UpeGr2TN0grrtnTKnNbOzO8seaJY18qffqEK0OJ1GMQkpWSC+kncNosHg3ZLGjZzZR3AjdkXYbWCWjk2S7IJg4xqXimyHMCnpOakQ8gpnhSUPG4ROuV4wl6zxLjmUxYSc1OlHy23kYJANK8r2HCLrYyDfPU0NjqWXB4KYAZaSQVB9Q+srDGbFDHaBToQ0RhWhG7eZSFSS9DNByTsExJjs9CWYMhGDBiJJVni6g9Z+3RoSlHqAjRMtqT1A7lP8MuRjLOtlGGEJfasXbSyzlDiFuemjlXN5lP0ChKCMceFX5JLaLLr2h1O3fNy06v0t/UGuAA36P2zJqUSaM1S79HVXRvPwA/GKsS3Gs5Z+ukX/6Q8LeZ+Qm6ajlNZRzQd9/aHRyjfdVr48O+8lJFUxmr/v9ZE5qm0mg3kalb809z/pE4BaIqyuGcyxvtTlfanYiUrGP0o1vSz9EAfplyoxLE9zxmCyG+SO+GZ/UqoghsrbFDo4dT6cI5D2OjZlPtGl9JOd7k/2WTn8Zjy2Pyocb97VU0QD9sfab9YIM/W+FPxZORepUktKHZol8Rov3PjJRDlqP6hnq+op7tnEE/TDTAZ1T6eTn8jFoVhzjOJeoHTQaFTkGjGyO1d29Uqq9Sn+9P3UBtK9VPqB2t97YBHe+AzvdgTnYwZ1iDCsxvDdTR7FysSZ8bON9h1feQfs1IG07tbIdUHOgR9muQeV3Lcu5MlH+F0WqJhFPWmc0ZDdIga2kJM4KmKTuB9ktwzhCXHuQChF9iVplHiFLuCMOFlZ4x59gbWyv8bC3/NUktsrfN99pqLfW1qTT9RLHPHeXSDS/1Kl9124lyvnCsguEVx4v+mn+w5U8HiC4o/5r9HQeIcn2iwV4bGkmlhtr4SRi5v8biaMtui/8iH7vyNUiheYFIHFrzmrBiLcWLclEVQjwY+/xozDOE6M7ZZpw3pUulKUldaLZWEP3y3f1Vs/UNXZ1YfiofoNzrdv5ooqm90VKXB1sNZRrvW0bpX3yhr8o="}}